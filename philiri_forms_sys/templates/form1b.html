{% extends "base.html" %}
{% block content %}
<div class="printable">
  <h1 class="center">Phil‑IRI Form 1B<br>Screening Test Class Reading Record (STCRR)</h1>
  <div class="meta2">
    <div><b>Grade:</b> {{cls.grade}}</div><div><b>Section:</b> {{cls.section or '—'}}</div>
    <div><b>School:</b> {{cls.school or '—'}}</div><div><b>Teacher:</b> {{cls.teacher or '—'}}</div>
    <div style="grid-column: 1 / span 2"><b>Screening Test Level:</b> {{cls.screening_level_eng}}</div>
    <div style="grid-column: 3 / span 2"><b>Date:</b> {{cls.date_text or '—'}}</div>
  </div>

  <table class="formtable">
    <thead>
      <tr>
        <th rowspan="2" class="c">#</th>
        <th rowspan="2">Name<br><span class="muted">(Male)</span></th>
        <th rowspan="2" class="c">Test Taken<br>✓/✗</th>
        <th colspan="3" class="c">Number of Correct Responses</th>
        <th rowspan="2" class="c">Overall<br>Score</th>
        <th rowspan="2" class="c">Score<br>&lt; 28</th>
        <th rowspan="2" class="c">Score<br>≥ 28 *</th>
        <th rowspan="2" class="c">Starting Point<br>of Graded Passage</th>
      </tr>
      <tr>
        <th class="c">Literal</th><th class="c">Inferential</th><th class="c">Critical</th>
      </tr>
    </thead>
    <tbody>
      {% for s in males %}
      {% set tot = compute_total(s.eng_literal, s.eng_inferential, s.eng_critical) %}
      <tr>
        <td class="c">{{ loop.index }}</td>
        <td>{{ s.name }}</td>
        <td class="c">{{ "✓" if s.took_eng else "✗" }}</td>
        <td class="c">{{ s.eng_literal }}</td>
        <td class="c">{{ s.eng_inferential }}</td>
        <td class="c">{{ s.eng_critical }}</td>
        <td class="c">{{ tot }}</td>
        <td class="c">{{ "✓" if tot < disc else "" }}</td>
        <td class="c">{{ "✓" if tot >= disc else "" }}</td>
        <td class="c">{{ starting_point_for(cls.grade, tot) }}</td>
      </tr>
      {% endfor %}
      <tr><td colspan="10" class="subhdr">(Female)</td></tr>
      {% for s in females %}
      {% set tot = compute_total(s.eng_literal, s.eng_inferential, s.eng_critical) %}
      <tr>
        <td class="c">{{ loop.index }}</td>
        <td>{{ s.name }}</td>
        <td class="c">{{ "✓" if s.took_eng else "✗" }}</td>
        <td class="c">{{ s.eng_literal }}</td>
        <td class="c">{{ s.eng_inferential }}</td>
        <td class="c">{{ s.eng_critical }}</td>
        <td class="c">{{ tot }}</td>
        <td class="c">{{ "✓" if tot < disc else "" }}</td>
        <td class="c">{{ "✓" if tot >= disc else "" }}</td>
        <td class="c">{{ starting_point_for(cls.grade, tot) }}</td>
      </tr>
      {% endfor %}
      <tr class="footer">
        <td colspan="10"><i>Total learners:</i> {{ (males|length) + (females|length) }}</td>
      </tr>
    </tbody>
  </table>
  <div class="printnote">* If score is ≥ {{disc}}, <b>DISCONTINUE</b>.</div>
</div>
{% endblock %}
