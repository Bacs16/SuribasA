{% extends "base.html" %}
{% block content %}
<div class="printable">
  <h1 class="center">Phil‑IRI Form 1A<br>Talaan ng Pangkatang Pagtatasa ng Klase (TPPK)</h1>
  <div class="meta2">
    <div><b>Baitang:</b> {{cls.grade}}</div><div><b>Seksyon:</b> {{cls.section or '—'}}</div>
    <div><b>Paaralan:</b> {{cls.school or '—'}}</div><div><b>Guro:</b> {{cls.teacher or '—'}}</div>
    <div style="grid-column: 1 / span 2"><b>Antas ng Pangk. Pagtatasa:</b> {{cls.screening_level_fil}}</div>
    <div style="grid-column: 3 / span 2"><b>Petsa:</b> {{cls.date_text or '—'}}</div>
  </div>

  <table class="formtable">
    <thead>
      <tr>
        <th rowspan="2" class="c">#</th>
        <th rowspan="2">Pangalan<br><span class="muted">(Lalake)</span></th>
        <th rowspan="2" class="c">Nakuhang<br>Pagtatasa<br>✓/✗</th>
        <th colspan="3" class="c">Bilang ng Tamang Sagot<br>(ayon sa Uri ng Tanong)</th>
        <th rowspan="2" class="c">Kabuuang<br>Marka</th>
        <th rowspan="2" class="c">g &lt; 28</th>
        <th rowspan="2" class="c">g ≥ 28 *</th>
        <th rowspan="2" class="c">Starting Point<br>of Graded Passage</th>
      </tr>
      <tr>
        <th class="c">Literal</th><th class="c">Paghihinuha</th><th class="c">Kritikal</th>
      </tr>
    </thead>
    <tbody>
      {% for s in males %}
      {% set tot = compute_total(s.fil_literal, s.fil_inferential, s.fil_critical) %}
      <tr>
        <td class="c">{{ loop.index }}</td>
        <td>{{ s.name }}</td>
        <td class="c">{{ "✓" if s.took_fil else "✗" }}</td>
        <td class="c">{{ s.fil_literal }}</td>
        <td class="c">{{ s.fil_inferential }}</td>
        <td class="c">{{ s.fil_critical }}</td>
        <td class="c">{{ tot }}</td>
        <td class="c">{{ "✓" if tot < disc else "" }}</td>
        <td class="c">{{ "✓" if tot >= disc else "" }}</td>
        <td class="c">{{ starting_point_for(cls.grade, tot) }}</td>
      </tr>
      {% endfor %}
      <tr><td colspan="10" class="subhdr">(<i>Babae</i>)</td></tr>
      {% for s in females %}
      {% set tot = compute_total(s.fil_literal, s.fil_inferential, s.fil_critical) %}
      <tr>
        <td class="c">{{ loop.index }}</td>
        <td>{{ s.name }}</td>
        <td class="c">{{ "✓" if s.took_fil else "✗" }}</td>
        <td class="c">{{ s.fil_literal }}</td>
        <td class="c">{{ s.fil_inferential }}</td>
        <td class="c">{{ s.fil_critical }}</td>
        <td class="c">{{ tot }}</td>
        <td class="c">{{ "✓" if tot < disc else "" }}</td>
        <td class="c">{{ "✓" if tot >= disc else "" }}</td>
        <td class="c">{{ starting_point_for(cls.grade, tot) }}</td>
      </tr>
      {% endfor %}
      <tr class="footer">
        <td colspan="10"><i>Kabuuang Bilang ng Mag-aaral:</i> {{ (males|length) + (females|length) }}</td>
      </tr>
    </tbody>
  </table>
  <div class="printnote">* Kung marka ay ≥ {{disc}}, <b>DISCONTINUE</b>.</div>
</div>
{% endblock %}
